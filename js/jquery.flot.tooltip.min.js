/*
 * jquery.flot.tooltip
 * 
 * description: easy-to-use tooltips for Flot charts
 * version: 0.5 alpha
 * author: Krzysztof Urbas @krzysu [myviews.pl]
 * website: https://github.com/krzysu/flot.tooltip
 * 
 * build on 2012-12-29
 * released under MIT License, 2012
*/
(function(a){var b={defaultOptions:{tooltip:!1,tooltipOpts:{content:"%s | X: %x | Y: %y.2",dateFormat:"%y-%0m-%0d",shifts:{x:10,y:20},defaultTheme:!0}},tipPosition:{x:0,y:0},init:function(c){var d=b;c.hooks.bindEvents.push(function(b,c){d.plotOptions=b.getOptions();if(d.plotOptions.tooltip===!1||typeof d.plotOptions.tooltip=="undefined")return;d.tooltipOptions=d.plotOptions.tooltipOpts;var e=d.getDomElement();a(b.getPlaceholder()).bind("plothover",function(a,b,c){if(c){var f,g=d.tooltipOptions.content;d.plotOptions.xaxis.mode==="time"||d.plotOptions.xaxes[0].mode==="time"?f=d.stringFormat(g,c,d.timestampToDate):f=d.stringFormat(g,c),e.html(f).css({left:d.tipPosition.x+d.tooltipOptions.shifts.x,top:d.tipPosition.y+d.tooltipOptions.shifts.y}).show()}else e.hide().html("")}),c.mousemove(d.onMouseMove)})},getDomElement:function(){var b;return a("#flotTip").length>0?b=a("#flotTip"):(b=a("<div />").attr("id","flotTip"),b.appendTo("body").hide().css({position:"absolute"}),this.tooltipOptions.defaultTheme&&b.css({background:"#fff","z-index":"100",padding:"0.4em 0.6em","border-radius":"0.5em","font-size":"0.8em",border:"1px solid #111"})),b},updateTooltipPosition:function(a){this.tipPosition.x=a.x,this.tipPosition.y=a.y},onMouseMove:function(a){var c={x:0,y:0};c.x=a.pageX,c.y=a.pageY,b.updateTooltipPosition(c)},timestampToDate:function(c){var d=new Date(c);return a.plot.formatDate(d,b.tooltipOptions.dateFormat)},stringFormat:function(a,b,c){var d=/%p\.{0,1}(\d{0,})/,e=/%s/,f=/%x\.{0,1}(\d{0,})/,g=/%y\.{0,1}(\d{0,})/;return typeof b.series.percent!="undefined"&&(a=this.adjustValPrecision(d,a,b.series.percent)),typeof b.series.label!="undefined"&&(a=a.replace(e,b.series.label)),typeof c=="function"?a=a.replace(f,c(b.series.data[b.dataIndex][0])):typeof b.series.data[b.dataIndex][0]=="number"&&(a=this.adjustValPrecision(f,a,b.series.data[b.dataIndex][0])),typeof b.series.data[b.dataIndex][1]=="number"&&(a=this.adjustValPrecision(g,a,b.series.data[b.dataIndex][1])),a},adjustValPrecision:function(a,b,c){var d;return b.match(a)!=="null"&&(RegExp.$1!==""&&(d=RegExp.$1,c=c.toFixed(d)),b=b.replace(a,c)),b}};a.plot.plugins.push({init:b.init,options:b.defaultOptions,name:"tooltip",version:"0.5"})})(jQuery);